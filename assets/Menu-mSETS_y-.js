import{d as b,r as t,k as F,l as q,s as r,j as e,e as C,I as w,J as O,K as Q,M as R,N as B}from"./index-Cjb8kro6.js";import{M as k}from"./Modal-Cfe-xpKF.js";import{P as G}from"./plus-CGoxE8aw.js";import{S as H}from"./search-GjYs47sv.js";import{P as J}from"./pen-3htcqnFF.js";const K=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],V=b("folder-plus",K);const Z=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],U=b("toggle-left",Z);const W=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],X=b("toggle-right",W);function te(){const[o,I]=t.useState([]),[j,S]=t.useState([]),[M,_]=t.useState(!0),[c,u]=t.useState(null),[h,E]=t.useState(""),[A,d]=t.useState(!1),[z,m]=t.useState(!1),[x,f]=t.useState(null),[s,i]=t.useState({name:"",category_id:0,price:"",description:"",available:!0}),[p,v]=t.useState("");t.useEffect(()=>{n()},[]);async function n(){try{const[a,l]=await Promise.all([F(),q()]);I(a),S(l)}catch(a){console.error("Error loading data:",a),r("Errore nel caricamento dati","error")}finally{_(!1)}}const N=j.filter(a=>{if(c&&a.category_id!==c)return!1;if(h){const l=h.toLowerCase();return a.name.toLowerCase().includes(l)||a.description?.toLowerCase().includes(l)}return!0});function y(a){a?(f(a),i({name:a.name,category_id:a.category_id,price:a.price.toString(),description:a.description||"",available:a.available})):(f(null),i({name:"",category_id:o[0]?.id||0,price:"",description:"",available:!0})),d(!0)}async function $(){if(!s.name||!s.price||!s.category_id){r("Compila tutti i campi obbligatori","warning");return}try{const a={name:s.name,category_id:s.category_id,price:parseFloat(s.price),description:s.description||void 0,available:s.available};x?(await w(x.id,a),r("Articolo aggiornato","success")):(await Q(a),r("Articolo creato","success")),d(!1),n()}catch(a){console.error("Error saving item:",a),r("Errore nel salvataggio","error")}}async function D(a){if(confirm("Sei sicuro di voler eliminare questo articolo?"))try{await O(a),r("Articolo eliminato","success"),n()}catch(l){console.error("Error deleting item:",l),r("Errore nell'eliminazione","error")}}async function L(a){try{await w(a.id,{available:!a.available}),r(a.available?"Articolo disabilitato":"Articolo abilitato","success"),n()}catch(l){console.error("Error toggling item:",l),r("Errore nell'aggiornamento","error")}}async function P(){if(!p.trim()){r("Inserisci un nome per la categoria","warning");return}try{await R({name:p.trim()}),r("Categoria creata","success"),v(""),m(!1),n()}catch(a){console.error("Error creating category:",a),r("Errore nella creazione","error")}}async function T(a){if(j.some(g=>g.category_id===a)){r("Impossibile eliminare: la categoria contiene articoli","warning");return}if(confirm("Sei sicuro di voler eliminare questa categoria?"))try{await B(a),r("Categoria eliminata","success"),c===a&&u(null),n()}catch(g){console.error("Error deleting category:",g),r("Errore nell'eliminazione","error")}}return M?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Menu"}),e.jsx("p",{className:"text-dark-400 mt-1",children:"Gestisci il menu del ristorante"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>m(!0),className:"btn-secondary",children:[e.jsx(V,{className:"w-5 h-5"}),"Nuova Categoria"]}),e.jsxs("button",{onClick:()=>y(),className:"btn-primary",children:[e.jsx(G,{className:"w-5 h-5"}),"Nuovo Articolo"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-xs",children:[e.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-dark-400"}),e.jsx("input",{type:"text",placeholder:"Cerca articolo...",value:h,onChange:a=>E(a.target.value),className:"input pl-10"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>u(null),className:`px-4 py-2 rounded-xl font-medium transition-all ${c===null?"bg-primary-500 text-dark-900":"bg-dark-800 text-dark-300 hover:bg-dark-700"}`,children:"Tutti"}),o.map(a=>e.jsx("button",{onClick:()=>u(a.id),className:`px-4 py-2 rounded-xl font-medium transition-all ${c===a.id?"bg-primary-500 text-dark-900":"bg-dark-800 text-dark-300 hover:bg-dark-700"}`,children:a.name},a.id))]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:N.map(a=>e.jsx("div",{className:`card transition-all ${a.available?"":"opacity-50"}`,children:e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-white truncate",children:a.name}),e.jsx("p",{className:"text-sm text-dark-400",children:a.category_name})]}),e.jsxs("p",{className:"text-xl font-bold text-primary-400 ml-2",children:["€",a.price.toFixed(2)]})]}),a.description&&e.jsx("p",{className:"text-sm text-dark-400 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-dark-700",children:[e.jsxs("button",{onClick:()=>L(a),className:`flex items-center gap-2 text-sm ${a.available?"text-emerald-400":"text-dark-500"}`,children:[a.available?e.jsx(X,{className:"w-6 h-6"}):e.jsx(U,{className:"w-6 h-6"}),a.available?"Disponibile":"Non disponibile"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>y(a),className:"p-2 hover:bg-dark-700 rounded-lg transition-colors",children:e.jsx(J,{className:"w-4 h-4 text-dark-400"})}),e.jsx("button",{onClick:()=>D(a.id),className:"p-2 hover:bg-red-500/20 rounded-lg transition-colors",children:e.jsx(C,{className:"w-4 h-4 text-red-400"})})]})]})]})},a.id))}),N.length===0&&e.jsx("div",{className:"card p-12 text-center",children:e.jsx("p",{className:"text-dark-400",children:"Nessun articolo trovato"})}),e.jsx(k,{isOpen:A,onClose:()=>d(!1),title:x?"Modifica Articolo":"Nuovo Articolo",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Nome *"}),e.jsx("input",{type:"text",value:s.name,onChange:a=>i({...s,name:a.target.value}),className:"input",placeholder:"Nome articolo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Categoria *"}),e.jsx("select",{value:s.category_id,onChange:a=>i({...s,category_id:parseInt(a.target.value)}),className:"select",children:o.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Prezzo (€) *"}),e.jsx("input",{type:"number",step:"0.01",value:s.price,onChange:a=>i({...s,price:a.target.value}),className:"input",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Descrizione"}),e.jsx("textarea",{value:s.description,onChange:a=>i({...s,description:a.target.value}),className:"input resize-none h-24",placeholder:"Descrizione opzionale"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white",children:"Disponibile"}),e.jsx("button",{type:"button",onClick:()=>i({...s,available:!s.available}),className:`relative w-14 h-8 rounded-full transition-colors ${s.available?"bg-emerald-500":"bg-dark-600"}`,children:e.jsx("span",{className:`absolute top-1 w-6 h-6 bg-white rounded-full transition-transform ${s.available?"left-7":"left-1"}`})})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[e.jsx("button",{onClick:$,className:"btn-primary flex-1",children:x?"Salva Modifiche":"Crea Articolo"}),e.jsx("button",{onClick:()=>d(!1),className:"btn-secondary",children:"Annulla"})]})]})}),e.jsx(k,{isOpen:z,onClose:()=>m(!1),title:"Nuova Categoria",size:"sm",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Nome Categoria"}),e.jsx("input",{type:"text",value:p,onChange:a=>v(a.target.value),className:"input",placeholder:"Es. Bevande"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:P,className:"btn-primary flex-1",children:"Crea Categoria"}),e.jsx("button",{onClick:()=>m(!1),className:"btn-secondary",children:"Annulla"})]}),o.length>0&&e.jsxs("div",{className:"pt-4 border-t border-dark-700",children:[e.jsx("p",{className:"text-sm text-dark-400 mb-3",children:"Categorie esistenti"}),e.jsx("div",{className:"space-y-2",children:o.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-dark-900 rounded-lg",children:[e.jsx("span",{className:"text-white",children:a.name}),e.jsx("button",{onClick:()=>T(a.id),className:"p-1 hover:bg-red-500/20 rounded transition-colors",children:e.jsx(C,{className:"w-4 h-4 text-red-400"})})]},a.id))})]})]})})]})}export{te as Menu};
