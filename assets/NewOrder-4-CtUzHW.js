import{d as Ue,j as e,U as Ne,S as se,e as Ye,f as Qe,h as ge,u as We,i as Xe,k as Ge,l as He,r,m as Je,n as Ke,o as Ze,p as es,q as ss,s as u,X as ts,t as as,v as ns,w as rs,x as ls,y as is,z as os,A as Se}from"./index-CR4UKEb8.js";import{C as Ie}from"./clock-B3jelvVk.js";import{M as _e}from"./message-square-OWBYwjUA.js";import{M as ve}from"./minus-DsKyvvUJ.js";import{P as cs}from"./plus-CseZsL1d.js";import{B as ds}from"./banknote-DpN0hpfY.js";import{S as xs}from"./smartphone-CreCppAC.js";import{M as Te}from"./Modal-BXKHmram.js";import{u as ms}from"./useCurrency-BnABR2nb.js";import{C as us}from"./chevron-up-Tqne2HIN.js";const ps=[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]],hs=Ue("bike",ps);function Oe({isMobile:h=!1,orderType:f,setOrderType:N,selectedTable:L,setSelectedTable:U,onTableSelect:Y,tables:Q,customerName:te,setCustomerName:W,customerPhone:ae,setCustomerPhone:X,cart:b,cartItemsCount:ne,cartTotal:A,ivaRate:x,ivaAmount:T,ivaIncluded:O=!0,grandTotal:v,expandedItemId:i,setExpandedItemId:y,notes:j,setNotes:I,paymentMethod:m,setPaymentMethod:p,smacPassed:k,setSmacPassed:re,smacEnabled:q=!0,isSubmitting:w,clearCart:F,updateQuantity:C,removeFromCart:M,updateItemNotes:G,submitOrder:P,isSessionOrder:S=!1,sessionTableName:$}){return e.jsxs("div",{className:`flex flex-col ${h?"h-full":""}`,children:[S&&e.jsx("div",{className:"p-3 bg-primary-500/10 border-b border-primary-500/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-white",children:$}),e.jsx("p",{className:"text-sm text-primary-400",children:"Aggiungi al conto"})]}),e.jsx("div",{className:"px-3 py-1 bg-primary-500/20 rounded-lg",children:e.jsx("span",{className:"text-sm font-medium text-primary-400",children:"Conto Aperto"})})]})}),!S&&e.jsxs("div",{className:"p-3 border-b border-dark-700",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>N("dine_in"),className:`flex items-center justify-center gap-2 px-3 py-2.5 rounded-xl transition-all flex-1 ${f==="dine_in"?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(Ne,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Tavolo"})]}),e.jsxs("button",{onClick:()=>N("takeaway"),className:`flex items-center justify-center gap-2 px-3 py-2.5 rounded-xl transition-all flex-1 ${f==="takeaway"?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(Ie,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Asporto"})]}),e.jsxs("button",{onClick:()=>N("delivery"),className:`flex items-center justify-center gap-2 px-3 py-2.5 rounded-xl transition-all flex-1 ${f==="delivery"?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(hs,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Domicilio"})]})]}),f==="dine_in"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs text-dark-400 mb-2",children:"Seleziona tavolo:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.map(t=>e.jsx("button",{onClick:()=>Y?Y(t.id):U(t.id),className:`px-4 py-2 rounded-xl text-sm font-medium transition-all ${L===t.id?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:t.name},t.id))})]}),(f==="takeaway"||f==="delivery")&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Nome cliente",value:te,onChange:t=>W(t.target.value),className:"input py-2.5 text-base"}),e.jsx("input",{type:"tel",placeholder:"Telefono",value:ae,onChange:t=>X(t.target.value),className:"input py-2.5 text-base"})]})]}),e.jsxs("div",{className:"px-3 py-2 bg-dark-900/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-primary-400"}),e.jsxs("span",{className:"text-sm font-medium text-white",children:[ne," articoli"]})]}),b.length>0&&e.jsx("button",{onClick:F,className:"text-xs text-red-400 hover:text-red-300 transition-colors px-2 py-1",children:"Svuota"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 min-h-[150px]",children:b.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-dark-400 py-8",children:[e.jsx(se,{className:"w-12 h-12 mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Carrello vuoto"}),e.jsx("p",{className:"text-xs mt-1",children:"Tocca un prodotto per aggiungerlo"})]}):e.jsx("div",{className:"space-y-2",children:b.map(t=>e.jsxs("div",{className:"bg-dark-900 rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-white text-sm truncate",children:t.name}),e.jsxs("p",{className:"text-xs text-primary-400 mt-0.5",children:["â‚¬",t.price.toFixed(2)," Ã— ",t.quantity," = â‚¬",(t.price*t.quantity).toFixed(2)]}),t.notes&&i!==t.id&&e.jsxs("p",{className:"text-xs text-amber-400 mt-1 truncate",children:["ðŸ“ ",t.notes]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>y(i===t.id?null:t.id),className:`w-9 h-9 rounded-lg flex items-center justify-center transition-colors ${i===t.id||t.notes?"bg-amber-500/20 text-amber-400":"bg-dark-700 text-dark-400 hover:bg-dark-600"}`,children:e.jsx(_e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>C(t.id,-1),className:"w-9 h-9 rounded-lg bg-dark-700 flex items-center justify-center hover:bg-dark-600 transition-colors",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-8 text-center text-base font-semibold",children:t.quantity}),e.jsx("button",{onClick:()=>C(t.id,1),className:"w-9 h-9 rounded-lg bg-dark-700 flex items-center justify-center hover:bg-dark-600 transition-colors",children:e.jsx(cs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>M(t.id),className:"w-9 h-9 ml-1 text-red-400 hover:bg-red-500/20 rounded-lg transition-colors flex items-center justify-center",children:e.jsx(Ye,{className:"w-4 h-4"})})]})]}),i===t.id&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(_e,{className:"w-4 h-4 text-amber-400"}),e.jsx("span",{className:"text-xs text-amber-400 font-medium",children:"Note / Variazioni"})]}),e.jsx("input",{type:"text",value:t.notes||"",onChange:g=>G(t.id,g.target.value),placeholder:"Es: senza cipolla, piccante...",className:"w-full bg-dark-800 border border-dark-600 rounded-lg px-3 py-2 text-sm text-white placeholder-dark-500 focus:outline-none focus:border-amber-500"}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:["Senza cipolla","Piccante","Extra salsa","Ben cotto"].map(g=>e.jsxs("button",{onClick:()=>{const E=t.notes||"",le=E?`${E}, ${g}`:g;G(t.id,le)},className:"px-2.5 py-1 text-xs bg-dark-700 text-dark-300 rounded-lg hover:bg-dark-600 transition-colors",children:["+ ",g]},g))})]})]},t.id))})}),b.length>0&&e.jsxs("div",{className:"border-t border-dark-700 bg-dark-800",children:[e.jsx("div",{className:"px-3 py-2 border-b border-dark-700",children:e.jsx("input",{type:"text",placeholder:"Note ordine (opzionale)...",value:j,onChange:t=>I(t.target.value),className:"input py-2.5 text-base"})}),!S&&e.jsxs("div",{className:"px-3 py-3 flex items-center gap-2 border-b border-dark-700",children:[e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsxs("button",{onClick:()=>p("cash"),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-xl transition-all flex-1 ${m==="cash"?"bg-emerald-500 text-white":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(ds,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Contanti"})]}),e.jsxs("button",{onClick:()=>p("card"),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-xl transition-all flex-1 ${m==="card"?"bg-blue-500 text-white":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(Qe,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Carta"})]}),e.jsxs("button",{onClick:()=>p("online"),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-xl transition-all flex-1 ${m==="online"?"bg-purple-500 text-white":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(xs,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Online"})]})]}),q&&e.jsxs("button",{onClick:()=>re(!k),className:`flex items-center gap-1.5 px-4 py-2 rounded-xl transition-all ${k?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[k&&e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"SMAC"})]})]}),e.jsx("div",{className:"px-3 py-3 space-y-1",children:S?e.jsxs("div",{className:"flex justify-between text-xl font-bold text-white",children:[e.jsx("span",{children:"Totale Comanda"}),e.jsxs("span",{className:"text-primary-400",children:["â‚¬",A.toFixed(2)]})]}):O?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-xl font-bold text-white",children:[e.jsx("span",{children:"Totale"}),e.jsxs("span",{className:"text-primary-400",children:["â‚¬",v.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-dark-500",children:[e.jsxs("span",{children:["di cui IVA (",x,"%)"]}),e.jsxs("span",{children:["â‚¬",T.toFixed(2)]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm text-dark-400",children:[e.jsx("span",{children:"Subtotale"}),e.jsxs("span",{children:["â‚¬",A.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-dark-400",children:[e.jsxs("span",{children:["+ IVA (",x,"%)"]}),e.jsxs("span",{children:["â‚¬",T.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xl font-bold text-white pt-2",children:[e.jsx("span",{children:"Totale"}),e.jsxs("span",{className:"text-primary-400",children:["â‚¬",v.toFixed(2)]})]})]})}),e.jsx("div",{className:"p-3 pt-0 pb-safe",children:e.jsx("button",{onClick:P,disabled:b.length===0||w,className:"btn-primary w-full py-4 text-base font-semibold",children:w?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-dark-900"}):S?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-5 h-5"}),"Invia Comanda - â‚¬",A.toFixed(2)]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-5 h-5"}),"Conferma Ordine - â‚¬",v.toFixed(2)]})})})]}),b.length===0&&e.jsx("div",{className:"p-3 border-t border-dark-700 pb-safe",children:e.jsxs("button",{disabled:!0,className:"btn-primary w-full py-4 opacity-50 cursor-not-allowed text-base",children:[e.jsx(se,{className:"w-5 h-5"}),"Aggiungi prodotti"]})})]})}function Ss(){We();const{formatPrice:h}=ms(),{smacEnabled:f}=Xe(),N=Ge(),[L]=He(),[U,Y]=r.useState([]),[Q,te]=r.useState([]),[W,ae]=r.useState([]),[X,b]=r.useState(null),[ne,A]=r.useState(!0),[x,T]=r.useState(null),[O,v]=r.useState(null),[i,y]=r.useState([]),[j,I]=r.useState("dine_in"),[m,p]=r.useState(null),[k,re]=r.useState("cash"),[q,w]=r.useState(""),[F,C]=r.useState(""),[M,G]=r.useState(""),[P,S]=r.useState(!1),[$,t]=r.useState(!1),[g,E]=r.useState(null),[le,ie]=r.useState(!1),[qe,H]=r.useState(!1),[o,oe]=r.useState(null),[ce,de]=r.useState([]),[J,xe]=r.useState(null),[Fe,K]=r.useState(!1),[D,me]=r.useState(null),[c,Z]=r.useState({covers:"2",customer_name:"",customer_phone:""}),ue=L.get("session"),pe=L.get("table");r.useEffect(()=>{$e()},[ue,pe]);async function $e(){try{const[s,a,l,n]=await Promise.all([Je(),Ke(),Ze(),es()]);if(Y(s),te(a),ae(l),b(n),s.length>0&&v(s[0].id),ue){const R=parseInt(ue),d=await ss(R);d&&(T(d),p(d.table_id),I("dine_in"),d.customer_name&&w(d.customer_name),d.customer_phone&&C(d.customer_phone))}else pe&&(p(parseInt(pe)),I("dine_in"))}catch(s){console.error("Error loading data:",s),u("Errore nel caricamento dati","error")}finally{A(!1)}}const ye=O?Q.filter(s=>s.category_id===O&&s.available):Q.filter(s=>s.available),_=i.reduce((s,a)=>s+a.price*a.quantity,0),V=i.reduce((s,a)=>s+a.quantity,0),he=X?.iva_rate||17,fe=X?.iva_included!==!1,ke=fe?_-_/(1+he/100):_*(he/100),B=fe?_:_+ke;function we(s){y(a=>a.find(n=>n.id===s.id)?a.map(n=>n.id===s.id?{...n,quantity:n.quantity+1}:n):[...a,{...s,quantity:1}]),u(`${s.name} aggiunto`,"success")}function be(s,a){y(l=>l.map(n=>n.id===s?{...n,quantity:Math.max(0,n.quantity+a)}:n).filter(n=>n.quantity>0))}function ze(s){y(a=>a.filter(l=>l.id!==s))}function Ae(s,a){y(l=>l.map(n=>n.id===s?{...n,notes:a}:n))}function Me(){y([]),E(null)}async function Pe(s){if(x)return;const a=await ns(s);if(a){const l=await rs(a.id);oe(a),de(l),xe(s),H(!0)}else p(s),T(null)}async function Ee(){!o||!J||(T(o),p(J),I("dine_in"),o.customer_name&&w(o.customer_name),o.customer_phone&&C(o.customer_phone),H(!1),oe(null),de([]),xe(null),u("Comanda associata al conto aperto","success"))}function De(){J&&p(J),H(!1),oe(null),de([]),xe(null)}async function Ve(){if(i.length===0){u("Aggiungi almeno un prodotto","warning");return}if(j==="dine_in"&&!m&&!x){u("Seleziona un tavolo","warning");return}if(j==="dine_in"&&m&&!x){const s={date:new Date().toISOString().split("T")[0],total:B,payment_method:k,order_type:j,table_id:m,notes:M||void 0,status:"pending",smac_passed:P,customer_name:q||void 0,customer_phone:F||void 0},a=i.map(n=>({menu_item_id:n.id,quantity:n.quantity,price:n.price,notes:n.notes})),l=W.find(n=>n.id===m)?.name||`Tavolo ${m}`;Z({covers:"2",customer_name:q||"",customer_phone:F||""}),me({order:s,items:a,tableId:m,tableName:l}),K(!0);return}await je()}async function je(s,a){t(!0);try{const l=i.map(z=>({menu_item_id:z.id,quantity:z.quantity,price:z.price,notes:z.notes})),n=x||s,R=x?.id||a;let d;R&&(d=await is(R));const Le={date:new Date().toISOString().split("T")[0],total:n?_:B,payment_method:n?"cash":k,order_type:j,table_id:j==="dine_in"?m??void 0:void 0,notes:M||void 0,status:"pending",smac_passed:n?!1:P,customer_name:q||void 0,customer_phone:F||void 0,session_id:R,order_number:d};if(await os(Le,l),x){await Se(x.id);const z=d&&d>1?`Comanda ${d} inviata!`:"Prima comanda inviata!";u(z,"success"),N("/tables")}else a?(await Se(a),u("Ordine creato e conto aperto!","success"),N("/tables")):(u("Ordine creato con successo!","success"),N("/orders"))}catch(l){console.error("Error creating order:",l),u("Errore nella creazione dell'ordine","error")}finally{t(!1)}}async function Be(){if(!D)return;const s=parseInt(c.covers)||1;if(s<1){u("Inserisci almeno 1 coperto","warning");return}t(!0);try{const a=await ls(D.tableId,s,c.customer_name||void 0,c.customer_phone||void 0);c.customer_name&&w(c.customer_name),c.customer_phone&&C(c.customer_phone),K(!1),me(null),await je(!0,a.id)}catch(a){console.error("Error creating session:",a),u("Errore nell'apertura del conto","error"),t(!1)}}async function Re(){D&&(K(!1),me(null),await je(!1))}if(ne)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})});const ee=!!x,Ce={orderType:j,setOrderType:ee?()=>{}:I,selectedTable:m,setSelectedTable:ee?()=>{}:p,onTableSelect:ee?void 0:Pe,tables:W,customerName:q,setCustomerName:w,customerPhone:F,setCustomerPhone:C,cart:i,cartItemsCount:V,cartTotal:_,ivaRate:he,ivaAmount:ke,ivaIncluded:fe,grandTotal:B,expandedItemId:g,setExpandedItemId:E,notes:M,setNotes:G,paymentMethod:k,setPaymentMethod:re,smacPassed:P,setSmacPassed:S,smacEnabled:f,isSubmitting:$,clearCart:Me,updateQuantity:be,removeFromCart:ze,updateItemNotes:Ae,submitOrder:Ve,isSessionOrder:ee,sessionTableName:x?.table_name};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden lg:flex gap-4 h-[calc(100vh-100px)]",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:U.map(s=>e.jsx("button",{onClick:()=>v(s.id),className:`px-6 py-3 rounded-xl font-medium whitespace-nowrap transition-all ${O===s.id?"bg-primary-500 text-dark-900":"bg-dark-800 text-dark-300 hover:bg-dark-700"}`,children:s.name},s.id))}),e.jsx("div",{className:"flex-1 overflow-y-auto pt-1",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4 pt-2",children:ye.map(s=>{const a=i.find(l=>l.id===s.id);return e.jsxs("button",{onClick:()=>we(s),className:"menu-item-card text-left relative overflow-visible",children:[a&&e.jsx("div",{className:"absolute -top-2.5 -right-2.5 w-7 h-7 bg-primary-500 rounded-full flex items-center justify-center text-sm font-bold text-dark-900 z-20 shadow-lg",children:a.quantity}),e.jsx("h3",{className:"font-semibold text-white mb-1 line-clamp-2",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-dark-400 mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("p",{className:"text-xl font-bold text-primary-400",children:h(s.price)}),a&&e.jsx("div",{onClick:l=>{l.stopPropagation(),be(s.id,-1)},className:"w-8 h-8 rounded-lg bg-dark-700 hover:bg-red-500/20 flex items-center justify-center transition-colors cursor-pointer",children:e.jsx(ve,{className:"w-4 h-4 text-red-400"})})]})]},s.id)})})})]}),e.jsx("div",{className:"w-[420px] flex flex-col bg-dark-800 rounded-2xl border border-dark-700",children:e.jsx(Oe,{...Ce})})]}),e.jsxs("div",{className:"lg:hidden flex flex-col h-[calc(100vh-120px)]",children:[e.jsx("div",{className:"flex gap-2 mb-3 overflow-x-auto pb-2 -mx-3 px-3",children:U.map(s=>e.jsx("button",{onClick:()=>v(s.id),className:`px-4 py-2.5 rounded-xl font-medium whitespace-nowrap transition-all text-sm ${O===s.id?"bg-primary-500 text-dark-900":"bg-dark-800 text-dark-300"}`,children:s.name},s.id))}),e.jsx("div",{className:"flex-1 overflow-y-auto -mx-3 px-3 pb-24 pt-3",children:e.jsx("div",{className:"grid grid-cols-2 gap-3 pt-1",children:ye.map(s=>{const a=i.find(l=>l.id===s.id);return e.jsxs("button",{onClick:()=>we(s),className:"relative bg-dark-800 rounded-xl p-3 text-left border border-dark-700 active:scale-[0.98] transition-transform overflow-visible",children:[a&&e.jsx("div",{className:"absolute -top-2.5 -right-2.5 w-6 h-6 bg-primary-500 rounded-full flex items-center justify-center text-xs font-bold text-dark-900 z-20 shadow-lg",children:a.quantity}),e.jsx("h3",{className:"font-semibold text-white text-sm line-clamp-2 mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-lg font-bold text-primary-400",children:h(s.price)}),a&&e.jsx("div",{onClick:l=>{l.stopPropagation(),be(s.id,-1)},className:"w-7 h-7 rounded-lg bg-dark-700 active:bg-red-500/30 flex items-center justify-center transition-colors",children:e.jsx(ve,{className:"w-3.5 h-3.5 text-red-400"})})]})]},s.id)})})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-dark-900 border-t border-dark-700 lg:hidden z-30 safe-bottom",children:e.jsxs("button",{onClick:()=>ie(!0),className:"w-full flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"w-6 h-6 text-primary-400"}),V>0&&e.jsx("span",{className:"absolute -top-2 -right-2 w-5 h-5 bg-primary-500 rounded-full flex items-center justify-center text-xs font-bold text-dark-900",children:V})]}),e.jsx("span",{className:"text-white font-medium",children:i.length===0?"Carrello vuoto":`${V} articoli`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold text-primary-400",children:h(B)}),e.jsx(us,{className:"w-5 h-5 text-dark-400"})]})]})}),le&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>ie(!1)}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-dark-800 rounded-t-3xl max-h-[90vh] flex flex-col animate-slide-up",children:[e.jsx("div",{className:"flex justify-center pt-3 pb-1",children:e.jsx("div",{className:"w-12 h-1.5 bg-dark-600 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-dark-700",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Il tuo ordine"}),e.jsx("button",{onClick:()=>ie(!1),className:"p-2 hover:bg-dark-700 rounded-lg transition-colors",children:e.jsx(ts,{className:"w-6 h-6 text-dark-400"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(Oe,{...Ce,isMobile:!0})})]})]})]}),e.jsx("style",{children:`
        @keyframes slide-up {
          from {
            transform: translateY(100%);
          }
          to {
            transform: translateY(0);
          }
        }
        .animate-slide-up {
          animation: slide-up 0.3s ease-out;
        }
        .safe-bottom {
          padding-bottom: env(safe-area-inset-bottom, 0);
        }
        .pb-safe {
          padding-bottom: env(safe-area-inset-bottom, 12px);
        }
      `}),e.jsx(Te,{isOpen:qe,onClose:()=>H(!1),title:"Conto Aperto Rilevato",size:"md",children:o&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-500/10 border border-amber-500/30 rounded-xl",children:[e.jsx(as,{className:"w-6 h-6 text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-400",children:"Questo tavolo ha giÃ  un conto aperto"}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:"Vuoi aggiungere la comanda al conto esistente?"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-900 rounded-xl",children:[e.jsx("h3",{className:"font-semibold text-white mb-3",children:o.table_name||`Tavolo ${o.table_id}`}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-dark-400",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Coperti"})]}),e.jsx("p",{className:"text-lg font-bold text-white",children:o.covers})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-dark-400",children:[e.jsx(Ie,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Comande"})]}),e.jsx("p",{className:"text-lg font-bold text-white",children:ce.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-dark-400",children:"Totale"}),e.jsx("p",{className:"text-lg font-bold text-primary-400",children:h(o.total)})]})]}),o.customer_name&&e.jsxs("p",{className:"mt-3 text-sm text-dark-400",children:["Cliente: ",e.jsx("span",{className:"text-white",children:o.customer_name})]}),ce.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-700",children:[e.jsx("p",{className:"text-sm text-dark-400 mb-2",children:"Comande esistenti:"}),e.jsx("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:ce.map(s=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-dark-300",children:["Comanda #",s.order_number||1]}),e.jsx("span",{className:"text-white",children:h(s.total)})]},s.id))})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:Ee,className:"btn-primary w-full py-3",children:"SÃ¬, aggiungi al conto"}),e.jsx("button",{onClick:De,className:"btn-secondary w-full",children:"No, crea ordine separato"})]})]})}),e.jsx(Te,{isOpen:Fe,onClose:()=>K(!1),title:"Aprire un Conto?",size:"md",children:D&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-primary-500/10 border border-primary-500/30 rounded-xl",children:[e.jsx(Ne,{className:"w-6 h-6 text-primary-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-primary-400",children:["Stai creando un ordine per ",D.tableName]}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:"Vuoi aprire un conto per questo tavolo? CosÃ¬ potrai aggiungere altre comande in seguito."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300 mb-1",children:"Numero Coperti *"}),e.jsx("input",{type:"number",min:"1",value:c.covers,onChange:s=>Z({...c,covers:s.target.value}),className:"input w-full",placeholder:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300 mb-1",children:"Nome Cliente (opzionale)"}),e.jsx("input",{type:"text",value:c.customer_name,onChange:s=>Z({...c,customer_name:s.target.value}),className:"input w-full",placeholder:"Es. Mario Rossi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300 mb-1",children:"Telefono (opzionale)"}),e.jsx("input",{type:"tel",value:c.customer_phone,onChange:s=>Z({...c,customer_phone:s.target.value}),className:"input w-full",placeholder:"Es. 333 1234567"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-900 rounded-xl",children:[e.jsx("h3",{className:"font-semibold text-white mb-2",children:"Riepilogo Ordine"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-dark-400",children:[V," articoli"]}),e.jsx("span",{className:"text-xl font-bold text-primary-400",children:h(B)})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:Be,disabled:$,className:"btn-primary w-full py-3",children:$?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-dark-900 mx-auto"}):"Apri Conto e Invia Ordine"}),e.jsx("button",{onClick:Re,disabled:$,className:"btn-secondary w-full",children:"No, solo ordine singolo (senza conto)"})]})]})})]})}export{Ss as NewOrder};
