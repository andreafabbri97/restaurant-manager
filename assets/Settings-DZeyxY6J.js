import{d,u as A,i as I,r as i,p as j,s as c,j as e,E as n,h as M,T as D,f as R,aq as T,a_ as U}from"./index-5XOTf7Jk.js";import{M as z}from"./Modal-DhCfed7J.js";import{D as P}from"./database-BokEfXGx.js";import{D as H}from"./dollar-sign-BRXE0Z1w.js";import{G as O}from"./globe-B-u8n6bB.js";const q=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],N=d("download",q);const F=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],v=d("external-link",F);const B=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Q=d("save",B);const G=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],J=d("store",G);function ee(){const{t:s,language:f,setLanguage:y}=A(),{smacEnabled:m,setSmacEnabled:w}=I(),[l,r]=i.useState(null),[k,S]=i.useState(!0),[h,u]=i.useState(!1),[_,o]=i.useState(!1);i.useEffect(()=>{C()},[]);async function C(){try{const a=await j();r(a)}catch(a){console.error("Error loading settings:",a),c(s("settings.errorLoading"),"error")}finally{S(!1)}}async function E(){if(l){u(!0);try{await U(l);const a=await j();r(a),c(s("settings.saved"),"success")}catch(a){console.error("Error saving settings:",a),c(s("settings.errorSaving"),"error")}finally{u(!1)}}}function L(){try{const a={};["categories","menu_items","tables","ingredients","inventory","orders","order_items","employees","work_shifts","reservations","expenses","settings"].forEach(g=>{const b=localStorage.getItem(`kebab_${g}`);b&&(a[g]=JSON.parse(b))});const V=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),p=URL.createObjectURL(V),x=document.createElement("a");x.href=p,x.download=`restaurant_backup_${new Date().toISOString().split("T")[0]}.json`,x.click(),URL.revokeObjectURL(p),c(s("settings.backupExported"),"success")}catch(a){console.error("Error exporting data:",a),c(s("settings.backupError"),"error")}}function $(){window.open("https://github.com/andreafabbri97/restaurant-manager/blob/main/supabase-schema.sql","_blank")}return k?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 max-w-4xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:s("settings.title")}),e.jsx("p",{className:"text-dark-400 mt-1 text-sm sm:text-base",children:s("settings.subtitle")})]}),e.jsx("button",{onClick:E,disabled:h,className:"btn-primary text-sm sm:text-base w-full sm:w-auto justify-center",children:h?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-dark-900"}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 sm:w-5 sm:h-5"}),s("common.save")]})})]}),e.jsx("div",{className:`card p-3 sm:p-4 ${n?"border-emerald-500/50":"border-amber-500/50"}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 rounded-xl flex items-center justify-center flex-shrink-0 ${n?"bg-emerald-500/20":"bg-amber-500/20"}`,children:e.jsx(P,{className:`w-5 h-5 sm:w-6 sm:h-6 ${n?"text-emerald-400":"text-amber-400"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-white text-sm sm:text-base",children:s("settings.database")}),n?e.jsxs("span",{className:"badge-success text-xs",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),s("settings.databaseConnected")]}):e.jsxs("span",{className:"badge-warning text-xs",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),s("settings.databaseDemo")]})]}),e.jsx("p",{className:"text-xs sm:text-sm text-dark-400 mt-1",children:s(n?"settings.databaseCloudDesc":"settings.databaseLocalDesc")})]}),!n&&e.jsxs("button",{onClick:()=>o(!0),className:"btn-secondary text-xs sm:text-sm w-full sm:w-auto justify-center",children:[e.jsx(v,{className:"w-4 h-4"}),s("settings.configureSupabase")]})]})}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("h2",{className:"font-semibold text-white text-sm sm:text-base",children:s("settings.shopInfo")})]}),e.jsxs("div",{className:"card-body space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs sm:text-sm",children:s("settings.shopName")}),e.jsx("input",{type:"text",value:l?.shop_name||"",onChange:a=>r(t=>t?{...t,shop_name:a.target.value}:null),className:"input text-sm sm:text-base",placeholder:s("settings.shopNamePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs sm:text-sm",children:s("settings.menuSlogan")}),e.jsx("input",{type:"text",value:l?.menu_slogan||"",onChange:a=>r(t=>t?{...t,menu_slogan:a.target.value}:null),className:"input text-sm sm:text-base",placeholder:s("settings.menuSloganPlaceholder")}),e.jsx("p",{className:"text-xs text-dark-500 mt-1",children:s("settings.menuSloganHint")})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs sm:text-sm",children:s("settings.address")}),e.jsx("input",{type:"text",value:l?.address||"",onChange:a=>r(t=>t?{...t,address:a.target.value}:null),className:"input text-sm sm:text-base",placeholder:s("settings.addressPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs sm:text-sm",children:s("settings.phone")}),e.jsx("input",{type:"tel",value:l?.phone||"",onChange:a=>r(t=>t?{...t,phone:a.target.value}:null),className:"input text-sm sm:text-base",placeholder:s("settings.phonePlaceholder")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs sm:text-sm",children:s("settings.email")}),e.jsx("input",{type:"email",value:l?.email||"",onChange:a=>r(t=>t?{...t,email:a.target.value}:null),className:"input text-sm sm:text-base",placeholder:s("settings.emailPlaceholder")})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("h2",{className:"font-semibold text-white text-sm sm:text-base",children:s("settings.financialSettings")})]}),e.jsxs("div",{className:"card-body space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs sm:text-sm",children:s("settings.currency")}),e.jsxs("select",{value:l?.currency||"€",onChange:a=>r(t=>t?{...t,currency:a.target.value}:null),className:"select text-sm sm:text-base",children:[e.jsx("option",{value:"€",children:s("settings.currencyEuro")}),e.jsx("option",{value:"$",children:s("settings.currencyDollar")}),e.jsx("option",{value:"£",children:s("settings.currencyPound")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs sm:text-sm",children:s("settings.vatRate")}),e.jsx("input",{type:"number",value:l?.iva_rate||17,onChange:a=>r(t=>t?{...t,iva_rate:parseFloat(a.target.value)||0}:null),className:"input text-sm sm:text-base",placeholder:"17"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs sm:text-sm",children:s("settings.stockThreshold")}),e.jsx("input",{type:"number",value:l?.default_threshold||10,onChange:a=>r(t=>t?{...t,default_threshold:parseFloat(a.target.value)||10}:null),className:"input text-sm sm:text-base",placeholder:"10"})]})]}),e.jsxs("div",{className:"pt-3 border-t border-dark-700",children:[e.jsx("label",{className:"label text-xs sm:text-sm mb-2",children:"Modalità IVA"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("button",{onClick:()=>r(a=>a?{...a,iva_included:!0}:null),className:`flex-1 flex items-center gap-3 p-3 rounded-xl border-2 transition-all ${l?.iva_included!==!1?"border-primary-500 bg-primary-500/10":"border-dark-700 bg-dark-800 hover:border-dark-600"}`,children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${l?.iva_included!==!1?"border-primary-500":"border-dark-500"}`,children:l?.iva_included!==!1&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-500"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-white text-sm",children:"IVA inclusa nei prezzi"}),e.jsx("p",{className:"text-xs text-dark-400",children:"I prezzi del menu sono già comprensivi di IVA (consigliato)"})]})]}),e.jsxs("button",{onClick:()=>r(a=>a?{...a,iva_included:!1}:null),className:`flex-1 flex items-center gap-3 p-3 rounded-xl border-2 transition-all ${l?.iva_included===!1?"border-primary-500 bg-primary-500/10":"border-dark-700 bg-dark-800 hover:border-dark-600"}`,children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${l?.iva_included===!1?"border-primary-500":"border-dark-500"}`,children:l?.iva_included===!1&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-500"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-white text-sm",children:"IVA esclusa dai prezzi"}),e.jsx("p",{className:"text-xs text-dark-400",children:"L'IVA viene aggiunta al totale dell'ordine"})]})]})]}),e.jsx("p",{className:"text-xs text-dark-500 mt-2",children:l?.iva_included!==!1?`Esempio: Un prodotto a €10 include già €${(10-10/(1+(l?.iva_rate||17)/100)).toFixed(2)} di IVA. Il cliente paga €10.`:`Esempio: Un prodotto a €10 + IVA (${l?.iva_rate||17}%) = €${(10*(1+(l?.iva_rate||17)/100)).toFixed(2)}. L'IVA viene aggiunta.`})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("h2",{className:"font-semibold text-white text-sm sm:text-base",children:s("settings.languageSection")})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs sm:text-sm",children:s("settings.language")}),e.jsxs("select",{value:f,onChange:a=>y(a.target.value),className:"select max-w-xs text-sm sm:text-base",children:[e.jsx("option",{value:"it",children:s("settings.italian")}),e.jsx("option",{value:"en",children:s("settings.english")})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("h2",{className:"font-semibold text-white text-sm sm:text-base",children:s("settings.smacSection")})]}),e.jsxs("div",{className:"card-body space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white text-sm sm:text-base",children:s("settings.smacEnabled")}),e.jsx("p",{className:"text-xs sm:text-sm text-dark-400",children:s("settings.smacEnabledDesc")})]}),e.jsx("button",{onClick:()=>w(!m),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${m?"bg-primary-500":"bg-dark-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-xl p-3 sm:p-4",children:e.jsxs("p",{className:"text-xs sm:text-sm text-blue-400",children:[e.jsxs("strong",{children:[s("settings.smacNote"),":"]})," ",s("settings.smacNoteDesc")]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("h2",{className:"font-semibold text-white text-sm sm:text-base",children:s("settings.backup")})]}),e.jsxs("div",{className:"card-body space-y-3 sm:space-y-4",children:[e.jsx("p",{className:"text-dark-400 text-xs sm:text-sm",children:s("settings.backupDesc")}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:L,className:"btn-secondary text-sm sm:text-base",children:[e.jsx(N,{className:"w-4 h-4 sm:w-5 sm:h-5"}),s("settings.exportBackup")]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("h2",{className:"font-semibold text-white text-sm sm:text-base",children:s("settings.about")})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4 text-center",children:[e.jsxs("div",{className:"p-3 sm:p-4 bg-dark-900 rounded-xl",children:[e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-primary-400",children:"2.5"}),e.jsx("p",{className:"text-xs sm:text-sm text-dark-400",children:s("settings.version")})]}),e.jsxs("div",{className:"p-3 sm:p-4 bg-dark-900 rounded-xl",children:[e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-blue-400",children:"React"}),e.jsx("p",{className:"text-xs sm:text-sm text-dark-400",children:s("settings.frontend")})]}),e.jsxs("div",{className:"p-3 sm:p-4 bg-dark-900 rounded-xl",children:[e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-emerald-400",children:"Supabase"}),e.jsx("p",{className:"text-xs sm:text-sm text-dark-400",children:s("settings.databaseType")})]}),e.jsxs("div",{className:"p-3 sm:p-4 bg-dark-900 rounded-xl",children:[e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-purple-400",children:"TS"}),e.jsx("p",{className:"text-xs sm:text-sm text-dark-400",children:s("settings.languageType")})]})]})})]}),e.jsx(z,{isOpen:_,onClose:()=>o(!1),title:"Configura Supabase",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-400 mb-2",children:"Come configurare Supabase:"}),e.jsxs("ol",{className:"text-sm text-dark-300 space-y-2 list-decimal list-inside",children:[e.jsxs("li",{children:["Vai su ",e.jsx("a",{href:"https://supabase.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary-400 underline",children:"supabase.com"})," e crea un account gratuito"]}),e.jsx("li",{children:"Crea un nuovo progetto"}),e.jsxs("li",{children:["Vai su ",e.jsx("strong",{children:"SQL Editor"})," e incolla lo schema SQL"]}),e.jsxs("li",{children:["Vai su ",e.jsx("strong",{children:"Settings → API"})," e copia URL e anon key"]}),e.jsxs("li",{children:["Crea un file ",e.jsx("code",{className:"bg-dark-700 px-1 rounded",children:".env"})," nella root del progetto con:",e.jsx("pre",{className:"mt-2 p-2 bg-dark-900 rounded text-xs overflow-x-auto",children:`VITE_SUPABASE_URL=your-project-url
VITE_SUPABASE_ANON_KEY=your-anon-key`})]}),e.jsx("li",{children:"Riavvia l'applicazione"})]})]}),e.jsxs("div",{className:"bg-dark-900 rounded-xl p-4",children:[e.jsxs("p",{className:"text-dark-300 mb-3",children:["Lo schema SQL completo si trova nel file ",e.jsx("code",{className:"bg-dark-700 px-1 rounded",children:"supabase-schema.sql"})," nella root del progetto."]}),e.jsxs("button",{onClick:$,className:"btn-secondary w-full",children:[e.jsx(v,{className:"w-4 h-4"}),"Apri Schema SQL su GitHub"]})]}),e.jsx("button",{onClick:()=>o(!1),className:"btn-primary w-full",children:"Ho capito"})]})})]})}export{ee as Settings};
